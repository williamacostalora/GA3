#| include: false
# Load packages
library(tidyverse)
# if your group needs any other packages, add them here
#| message: false
#| warning: false
#| include: false
# read in data
music <- read.csv("https://bcheggeseth.github.io/253_spring_2024/data/billboard.csv")
# Check out artists with at least 40 songs
music %>%
count(performer) %>%
filter(n >= 40) %>%
select(performer)
# Pick just one of these artists to study
my_artist <- music %>%
filter(performer == "___") %>%
select(-performer) %>%
group_by(song) %>%       # The last rows deal w songs that appear more than once
slice_sample(n = 1) %>%
ungroup()
# clean data, if necessary
#| include: false
# Load packages
library(tidyverse)
# if your group needs any other packages, add them here
#| message: false
#| warning: false
#| include: false
# read in data
music <- read.csv("https://bcheggeseth.github.io/253_spring_2024/data/billboard.csv")
# Check out artists with at least 40 songs
music %>%
count(performer) %>%
filter(n >= 40) %>%
select(performer)
# Pick just one of these artists to study
my_artist <- music %>%
filter(performer == "___") %>%
select(-performer) %>%
group_by(song) %>%       # The last rows deal w songs that appear more than once
slice_sample(n = 1) %>%
ungroup()
# clean data, if necessary
#| message: false
#| warning: false
library(dplyr)
library(ggplot2)
library(readr)
library(tidyr)
library(lubridate)
library(tidymodels)
library(kknn)
library(cluster)
library(tidyverse)
library(factoextra)
# load data
library(tidyverse)
library(cluster)      # to build the hierarchical clustering algorithm
library(factoextra)
music <- read_csv("https://bcheggeseth.github.io/253_spring_2024/data/billboard.csv")
# check it out
head(music)
music %>%
count(performer) %>%
filter(n >= 30)
# load data
library(tidyverse)
library(cluster)      # to build the hierarchical clustering algorithm
library(factoextra)
music <- read_csv("https://bcheggeseth.github.io/253_spring_2024/data/billboard.csv")
# check it out
head(music)
music %>%
count(performer) %>%
filter(n >= 30)
# Pick just one of these artists to study
my_artist <- music %>%
filter(performer == "Glee Cast") %>%
select(-performer) %>%
group_by(song) %>%
slice_sample(n = 1) %>%
ungroup()
my_artist <- my_artist %>%
column_to_rownames("song")
my_artist %>%
mutate(mode = as.factor(mode)) %>%
mutate(key = as.factor(key)) %>%
mutate(time_signature = as.factor(time_signature))
# Scenario 2: AT LEAST 1 feature x is a FACTOR (categorical)
# Use either a "complete", "single", "average", or "centroid" linkage
hier_model <- hclust(daisy(my_artist, metric = "gower"), method = "complete")
# Heat maps: ordered by the id variable (not clustering)
heatmap(scale(data.matrix(my_artist)), Colv = NA, Rowv = NA)
# Heat maps: ordered by dendrogram / clustering
heatmap(scale(data.matrix(my_artist)), Colv = NA)
# Dendrogram (change font size w/ cex)
fviz_dend(hier_model, cex = 1)
# Scenario 2: AT LEAST 1 feature x is a FACTOR (categorical)
# Use either a "complete", "single", "average", or "centroid" linkage
hier_model <- hclust(daisy(my_artist, metric = "gower"), method = "complete")
# Heat maps: ordered by the id variable (not clustering)
heatmap(scale(data.matrix(my_artist)), Colv = NA, Rowv = NA)
# Heat maps: ordered by dendrogram / clustering
heatmap(scale(data.matrix(my_artist)), Colv = NA)
# Dendrogram (change font size w/ cex)
fviz_dend(hier_model, cex = 1)
# Scenario 2: AT LEAST 1 feature x is a FACTOR (categorical)
# Use either a "complete", "single", "average", or "centroid" linkage
hier_model <- hclust(daisy(my_artist, metric = "gower"), method = "complete")
# Heat maps: ordered by the id variable (not clustering)
heatmap(scale(data.matrix(my_artist)), Colv = NA, Rowv = NA)
# Heat maps: ordered by dendrogram / clustering
heatmap(scale(data.matrix(my_artist)), Colv = NA)
# Dendrogram (change font size w/ cex)
fviz_dend(hier_model, cex = 1)
cluster_data <- my_artist %>%
mutate(hier_cluster_k = as.factor(cutree(hier_model, k = 6)))
# Visualize the clusters on the dendrogram (change font size w/ cex)
fviz_dend(hier_model, k = 6, cex = 0.35)
hier_model <- hclust(daisy(my_artist, metric = "gower"), method = "complete")
# Visualize the full dendrogram
fviz_dend(hier_model, cex = 0.5, main = "Complete Dendrogram of Glee Cast Songs")
#| label: elbow-silhouette
# Elbow method: look for the "elbow" in total within-cluster sum of squares
fviz_nbclust(my_artist,
FUN = hcut,
method = "wss",
k.max = 10) +
labs(title = "Elbow Method for Optimal k")
# Silhouette method: find k that maximizes average silhouette width
fviz_nbclust(my_artist,
FUN = hcut,
method = "silhouette",
k.max = 10) +
labs(title = "Silhouette Method for Optimal k")
# Calculate silhouette scores for k=4, 5, 6
sil_scores <- tibble(
k = 4:6,
avg_sil = map_dbl(4:6, ~{
clusters <- cutree(hier_model, k = .x)
sil <- silhouette(clusters, daisy(my_artist, metric = "gower"))
mean(sil[, 3])
})
)
print(sil_scores)
